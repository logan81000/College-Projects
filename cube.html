<!doctype html>
<html>
<body>
<style>
   canvas {
    padding-left: 0;
    padding-right: 0;
    margin-left: auto;
    margin-right: auto;
    display: block;
    width: 800px;
}
</style>
<canvas width = "600" height = "600" id = "cube"></canvas>
<script>
var canvas = document.getElementById('cube');
gl = canvas.getContext('webgl');

var vert = [
	-1,-1,-1, 1,-1,-1, 1, 1,-1, -1, 1,-1,
	-1,-1, 1, 1,-1, 1, 1, 1, 1, -1, 1, 1,
	-1,-1,-1, -1, 1,-1, -1, 1, 1, -1,-1, 1,
	 1,-1,-1, 1, 1,-1, 1, 1, 1, 1,-1, 1,
	-1,-1,-1, -1,-1, 1, 1,-1, 1, 1,-1,-1,
	-1, 1,-1, -1, 1, 1, 1, 1, 1, 1, 1,-1, 
];

var col = [
	0.890, 0.329, 0.0267, 0.890, 0.329, 0.0267, 0.890, 0.329, 0.0267, 0.890, 0.329, 0.0267,
	0.0672, 0.827, 0.840, 0.0672, 0.827, 0.840, 0.0672, 0.827, 0.840, 0.0672, 0.827, 0.840,
	0.207, 0.169, 0.360, 0.207, 0.169, 0.360, 0.207, 0.169, 0.360, 0.207, 0.169, 0.360,
	0.930, 0.0744, 0.702, 0.930, 0.0744, 0.702, 0.930, 0.0744, 0.702, 0.930, 0.0744, 0.702,
	0.617, 0.880, 0.537, 0.617, 0.880, 0.537, 0.617, 0.880, 0.537, 0.617, 0.880, 0.537,
	0.980, 0.873, 0.0588, 0.980, 0.873, 0.0588, 0.980, 0.873, 0.0588, 0.980, 0.873, 0.0588
];

var ind = [
	0,1,2, 0,2,3, 4,5,6, 4,6,7,
	8,9,10, 8,10,11, 12,13,14, 12,14,15,
	16,17,18, 16,18,19, 20,21,22, 20,22,23 
];

var vert_buff = gl.createBuffer ();
gl.bindBuffer(gl.ARRAY_BUFFER, vert_buff);
gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(vert), gl.STATIC_DRAW);

var col_buff = gl.createBuffer ();
gl.bindBuffer(gl.ARRAY_BUFFER, col_buff);
gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(col), gl.STATIC_DRAW);
var index_buff = gl.createBuffer ();
gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, index_buff);
gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, new Uint16Array(ind), gl.STATIC_DRAW);
var vert = 'attribute vec3 pos;'+
	'uniform mat4 P;'+
	'uniform mat4 V;'+
	'uniform mat4 M;'+
	'attribute vec3 col;'+
	'varying vec3 vcol;'+
	'void main(void) { '+
	'gl_Position = P*V*M*vec4(pos, 1.);'+
	'vcol = col;'+
'}';
var frag = 'precision mediump float;'+
	'varying vec3 vcol;'+
	'void main(void) {'+
	'gl_FragColor = vec4(vcol, 1.);'+
'}';

var vertshad = gl.createShader(gl.VERTEX_SHADER);
gl.shaderSource(vertshad, vert);
gl.compileShader(vertshad);
var fragshad = gl.createShader(gl.FRAGMENT_SHADER);
gl.shaderSource(fragshad, frag);
gl.compileShader(fragshad);
var shadprog = gl.createProgram();
gl.attachShader(shadprog, vertshad);
gl.attachShader(shadprog, fragshad);
gl.linkProgram(shadprog);
var P = gl.getUniformLocation(shadprog, "P");
var V = gl.getUniformLocation(shadprog, "V");
var M = gl.getUniformLocation(shadprog, "M");
gl.bindBuffer(gl.ARRAY_BUFFER, vert_buff);
var pos = gl.getAttribLocation(shadprog, "pos");
gl.vertexAttribPointer(pos, 3, gl.FLOAT, false,0,0) ;
gl.enableVertexAttribArray(pos);
gl.bindBuffer(gl.ARRAY_BUFFER, col_buff);
var col = gl.getAttribLocation(shadprog, "col");
gl.vertexAttribPointer(col, 3, gl.FLOAT, false,0,0) ;
gl.enableVertexAttribArray(col);
gl.useProgram(shadprog);
function get_proj(angle, a, zMin, zMax) {
	var ang = Math.tan((angle*.5)*Math.PI/180);
	return [
	0.5/ang, 0 , 0, 0,
	0, 0.5*a/ang, 0, 0,
	0, 0, -(zMax+zMin)/(zMax-zMin), -1,
	0, 0, (-2*zMax*zMin)/(zMax-zMin), 0 
	];
}

var proj = get_proj(40, canvas.width/canvas.height, 1, 100);
var mov = [1,0,0,0, 0,1,0,0, 0,0,1,0, 0,0,0,1];
var view = [1,0,0,0, 0,1,0,0, 0,0,1,0, 0,0,0,1];
view[14] = view[14]-6;
function Z(a, angle) {
	var cos = Math.cos(angle);
	var sin = Math.sin(angle);
	var a0 = a[0], a4 = a[4], a8 = a[8];
	a[0] = cos*a[0]-sin*a[1];
	a[4] = cos*a[4]-sin*a[5];
	a[8] = cos*a[8]-sin*a[9];
	a[1] = cos*a[1]+sin*a0;
	a[5] = cos*a[5]+sin*a4;
	a[9] = cos*a[9]+sin*a8;
}

function X(a, angle) {
var cos = Math.cos(angle);
var sin = Math.sin(angle);
var a1 = a[1], a5 = a[5], a9 = a[9];
	a[1] = a[1]*cos-a[2]*sin;
	a[5] = a[5]*cos-a[6]*sin;
	a[9] = a[9]*cos-a[10]*sin;
	a[2] = a[2]*cos+a1*sin;
	a[6] = a[6]*cos+a5*sin;
	a[10] = a[10]*cos+a9*sin;
}

function Y(a, angle) {
var cos = Math.cos(angle);
var sin = Math.sin(angle);
var a0 = a[0], a4 = a[4], a8 = a[8];
	a[0] = cos*a[0]+sin*a[2];
	a[4] = cos*a[4]+sin*a[6];
	a[8] = cos*a[8]+sin*a[10];
	a[2] = cos*a[2]-sin*a0;
	a[6] = cos*a[6]-sin*a4;
	a[10] = cos*a[10]-sin*a8;
}

var old = 0;
var animate = function(time) {
	var dt = time-old;
	Z(mov, dt*0.005);
	Y(mov, dt*0.002);
	X(mov, dt*0.003);
	old = time;
	gl.enable(gl.DEPTH_TEST);
	gl.depthFunc(gl.LEQUAL);
	gl.clearColor(0.6, 0.5, 0.5, 0.9);
	gl.clearDepth(1.0);
	gl.viewport(.0, 0.0, canvas.width, canvas.height);
	gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);
	gl.uniformMatrix4fv(P, false, proj);
	gl.uniformMatrix4fv(V, false, view);
	gl.uniformMatrix4fv(M, false, mov);
	gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, index_buff);
	gl.drawElements(gl.TRIANGLES, ind.length, gl.UNSIGNED_SHORT, 0);
	window.requestAnimationFrame(animate);
}

animate(0);
</script>
</body>
</html>